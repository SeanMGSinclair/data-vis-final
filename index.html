
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Combined Visualizations</title>

    <script src="https://cdn.jsdelivr.net/npm/vega@6.2.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@6.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@7.0.2"></script>

    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="Mark.css">

    <style>
      .section {
        margin-bottom: 70px;
      }
    </style>
  </head>

  <body>

    <div class="section">
      <div id="popularity_correlation_chart"></div>
    </div>

    <div class="section">
      <div class="header-row">
        <h1>Correlation Heatmap</h1>
      </div>

      <p class="note">Double click the heatmap to clear the selection.</p>

      <div class="container">
        <div id="vis"></div>

        <div class="right-panel">
          <h1 class="scatter-top-title">Scatter Plot</h1>

          <p id="infoBox">
            No pair selected, click a square on the heatmap to see the scatter plot.
          </p>

          <div id="scatter"></div>
        </div>
      </div>
    </div>

    <script>
      var popularity_correlation_chart = {
        $schema: 'https://vega.github.io/schema/vega-lite/v6.json',
        description: 'Bar graph visualizing what metrics best correlate with popularity -- by genre',
        title: 'What Best Correlates With Popularity?',
        data: {url:'popularity_correlation.csv'},
        params: [{
            name: 'genreParam',
            value: 'All',
            bind: {
              input: "select",
              name: 'Genre: ',
              options: [
                'All','dance','hip-hop','pop','reggaeton','latino','latin','alt-rock','chill',
                'reggae','indie','rock','groove','folk','piano','country','funk','edm',
                'k-pop','soul','indian','british','electro','alternative','synth-pop','emo',
                'indie-pop','techno','r-n-b','metal','house','sleep','hard-rock','blues',
                'pagode','trance','german','disco','garage','sad','singer-songwriter',
                'anime','dancehall','punk','swedish','acoustic','brazil','progressive-house',
                'power-pop','spanish','rockabilly','hardcore','pop-film','grunge','ambient',
                'french','punk-rock','psych-rock','chicago-house','j-pop','songwriter','jazz',
                'j-rock','children','turkish','electronic','salsa','deep-house','rock-n-roll',
                'industrial','show-tunes','comedy','ska','afrobeat','j-dance','dub','party',
                'death-metal','metalcore','disney','cantopop','mandopop','world-music','idm',
                'classical','dubstep','bluegrass','new-age','drum-and-bass','samba',
                'minimal-techno','opera','trip-hop','goth','mpb','club','hardstyle','happy',
                'malay','breakbeat','sertanejo','kids','heavy-metal','forro','guitar','j-idol',
                'gospel','black-metal','honky-tonk','study','detroit-techno','tango',
                'grindcore','romance','iranian'
              ]
            }
        }],
        transform: [{filter: 'datum.Genre === genreParam'}],
        mark: {type: 'bar', stroke:"black", strokeWidth: '1px'},
        encoding: {
          x: {
            field: 'Correlation',
            type: 'quantitative',
            axis: {title: 'Correlation Coefficient'},
            scale: {domain: [-1.0, 1.0]}
          },
          y: {
            field: 'Metric',
            type: 'nominal',
            sort: {op: 'mean', field: 'Correlation', order: 'descending'}
          },
          color: {
            field: "Correlation",
            type: "quantitative",
            scale: { domain: [-1, 0, 1], range: ["#b2182b", "#f7f7f7", "#2166ac"] },
          },
          tooltip: [
            {field: 'Metric'},
            {field: 'Correlation'},
            {field: 'Genre'}
          ]
        }
      };

      vegaEmbed('#popularity_correlation_chart', popularity_correlation_chart);
    </script>

    <script src="Mark.js"></script>

  </body>
</html>
